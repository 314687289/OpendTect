<html>
<!--
  - CopyRight:  (C) dGB Earth Sciences
  - Author:     Bert
  - Date:       Jan 2004
  - Contents:   Getting started developping your own plugins.
  - RCS:        $Id: unix.html,v 1.17 2012-04-17 13:32:44 cvsbert Exp $
 -->

<body background="backg.png"><title>Getting started with OpendTect development [OpendTect Programmer's manual V4.1]</title>
<center>
<h1>Getting started with OpendTect development</h1>
  <a href=#intro>Intro</a>
| <a href=#prereq>Prerequisites</a>
| <a href=#setup>Setup</a>
| <a href=#buildod>Building OpendTect</a>
</center>
<br>
<img src="hr.png" border=0>

<a name=intro><h2>Intro</h2></a>
<p>
In principle, anyone can build the full OpendTect system from source. Fortunately, OpendTect has a <a href="plugins.html">plugin</a> architecture which makes it much easier to start developing. Therefore, this manual will focus on plugin development rather than building the entire OpendTect from scratch. If for some reason you are interested in building the entire OpendTect, follow the instructions for plugin development before going <a href=#buildod">here</a>). Even if you want to build for a completely new platform, the first step would still be to get your environment ready for plugin development.
</p><p>
For both types of development you should have installed a fully functional OpendTect system before you start. Even when you build the entire OpendTect, you'll want to be able to use some of the libraries from the distribution.
</p><p>
MS Windows-based developers should not be here: instead, go to the <a href="windows.html">windows development section</a>.
</p>

<a name=prereq><h2>Prerequisites</h2></a>
<p>
Before you can start developing, there are a few external programs that need
to be installed.
</p><p>
The following programs should be available:
</p>
<ul>
<li><a href="http://cmake.org">CMake</a>
<li><a href="http://gcc.gnu.org">GNU gcc/g++ >= 3.4.x</a>
<li>csh (any, as long as you have one installed)
</ul>

<a name=setup><h2>Setting up the environment</h2></a>

<p>
<a href="http://cmake.org">CMake</a> is used to build both the entire system aswell as plugins.
</p>


<h3>Setup ODWork dir</h3>

<p>
It is strongly recommended to make sure that there are no spaces in the path
to your ODWork directory. A good place for your ODWork directory may be a subdirectory of your home directory. 
</p>

<p>
The only environment variable besides the one you may want to use for your own CMake settings is $WORK. Set it to the root of your development tree (which itself contains the plugin subdirectories).
</p><p>
For CMake to work easily, try linking the Qt, COIN and OSG installations immediately in $WORK. CMake will automatically configure from this. Example:
<pre><code>ln -s /apps/qt/inst_453 $WORK/qt
ln -s /apps/coin/inst_rel $WORK/coin
ln -s /apps/osg/inst_rel $WORK/osg
</code></pre>
</p>

<h3>Building your own plugins</h3>
<h4>Testing the installation</h4>

<p>
After 'cmake .' (ceemake dot) in the root of your development environment you can simply use make in each plugin directory. Then, as a test, try to make some changes in plugins/Hello and run make.
</p>

<h4>Testing the newly compiled plugins</h4>

<p>
You can test your newly compiled plugins by loading them using the Utilities-plugins menu in OpendTect. For example, if you load the "libHello.so" plugin, you should see "Hello World" on the OpendTect console window. Note that when plugins depend on other plugins, the order of loading matters.
</p><p>
There is no way to un-load a plugin. That means you have to exit OpendTect to test a new version (e.g. after recompile).
</p>

<a name=installplugins><h4>Installing your plugins</h4>

<p> Installing a plugin means: making it auto-loaded. This removes the nuisance of having to load the plugin each time you start OpendTect. On the other hand, when you're still developing you may not want the plugin to be loaded all the time. Anyway, the plugins are installed by linking or copying them to the correct plugin subdirectory in either your personal '.od' settings directory, or in the program installation directory and making a configuration ".alo" file. 
This is the same on Unix and Windows, so please consult the plugins <a href="plugins.html#autoload">auto-load and installation</a> documentation for more details.

<a name=dist><h2>Distributing your plugins</h2>

<p>
The distribution of plugins is basically the same for Unix and windows. 
Just copy the .alo files into the plugins/platform directory (<code>$DTECT_APPL/plugins/$HDIR</code>) and copy the actual plugins into the <code>bin/$DIR</code> subdirectory, where all shared libs reside.
</p>
<p>
For distribution to the outside world, you'll need to package your plugins, documentation, etc. into .tar.gz files on Unix. For all details on what exactly should be packaged and how, we'd recommend contacting support at opendtect.org.
</p>


<a name=buildod><h2>Building from source</h2>
<p>
If you're really into it, you can build the entire OpendTect from source after you've installed OpendTect and built a plugin. For that, you will have to get hold of a Qt and a COIN source distribution. This is because you'll need the correct header files to go with the libraries.

<h4>Qt = http://www.trolltech.no</h4>
Use Qt 4.5 or lower. We configured with:
<code>
./configure -shared -release -no-gif -enable-opengl -thread -no-g++-exceptions -disable-xml -disable-sql -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -qt-libpng -qt-libjpeg -qt-libmng -qt-imgfmt-jpeg -qt-imgfmt-mng -qt-imgfmt-png
</code>

<h4>COIN = http://www.sim.no</h4>
You need the main COIN library ('Coin-2') and SoQt. For the volume rendering plugin, find the SIMVoleon download too. In rare cases you also want simage. Our configuration:
<code>
./configure --disable-debug --disable-symbols --enable-shared --disable-static --enable-vrml97 --enable-threadsafe --enable-rtti --disable-warnings --disable-dependency-tracking --enable-html CFLAGS="-O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64" CPPFLAGS="-O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64" LDFLAGS="-s -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -lstdc++"
</code>
</p><p>
Once this is done, link your Qt and Coin installation directories to $WORK, as in:
<code>
cd $WORK
ln -s /apps/qt/inst_dir ./qt
ln -s /apps/coin/inst_dir ./coin
</code>
Now, you can configure cmake. As always, do a 'cmake .', this time in $WORK itself. If configuring succeeds, 'make' should do the trick.
<p>

<br>
<img src="hr.png" border=0>

<p>
<center>
  <a href="index.html">Index</a>
| <a href="overview.html">Overview</a>
| <a href="plugins.html">Plugins</a>
| <a href="http://www.opendtect.org">opendtect.org</a>
</center>
</p>

</body>
</html>
