<html>
<!--
  - CopyRight:  (C) dGB Earth Sciences
  - Author:     A.H. Lammertink / A.H. Bril
  - Date:       Jan 2004
  - Contents:   Getting started developping your own plugins.
  - RCS:        $Id: unix.html,v 1.1 2004-01-14 12:24:32 arend Exp $
 -->

<body background="../backg.png"><title>Getting started with OpendTect development [OpendTect Programmer's manual V1.0]</title>
<center>
<h1>Getting started with OpendTect development</h1>
  <a href=#prereq>Prerequisites</a>
| <a href=#setup>Setup</a>
| <a href=#buildod>Building OpendTect</a>
</center>
<br>
<img src="../hr.png" border=0>

<a name=prereq><h2>Prerequisites</h2></a>

<p>
Before you can start developing, there are a few external programs that need
to be installed. For Windows, see <a href="windows.html#external">external installations</a>.
</p><p>
On Unix, the following programs should be available:
</p>

<ul>
<li>GNU make</li>
<li>GNU gcc, including g++</li>
<li>tcsh</li>
<li>perl</li>
<li>GNU awk (gawk)</li>
</ul>
<p>Also recommended are:</p>
<ul>
<li>cvs</li>
<li>binutils</li>
<li>GNU bizon(*)</li>
<li>GNU flex (*)</li>
<li>doxygen</li>
</ul>

<p>(*) Bison and Flex are required to build OpendTect itself.</p>


<a name=setup><h2>Setting up the environment</h2></a>

<p>
<a href="pmake.html">Pmake</a> is used to build both the system and to
build plugins.
It requires a few environment variables to be setup and it expects a
certain directory structure in your ODWork directory.
</p>


<h3>Setup ODWork dir</h3>

<p>
Before you can build anything, you have to setup the ODWork directory in such
a way that Pmake can use it.
The easiest way to do this is from within OpendTect, menu 'Utilities-Create Development Environment'.
Note that the OpendTect application window will freeze while the development
environment is created.

'Create Development Environment' will also create init scripts 'init.bash'
and 'init.csh' in your ODWork directory that can easily be sourced from your
.bashrc or your .login to setup your environment.
</p>

<p>
It is strongly recommended to make sure that there are no spaces in the path
to your ODWork directory. A good place for your ODWork directory is your
home directory. 
</p>


<h3>Setup environment variables</h3>

<p>Once you have successfully created your ODWork directory, you have to setup a few environment variables: HDIR, WORK and GNUMAKE.</p>

<li>HDIR defines the platform you're working on, which is eigther lux, sun5, sgi or win.</li>
<li>GNUMAKE gives the name of gnu make, usually just make or gmake.</li>
<li>WORK defines where your ODWork directory is.</li>

<p>
Beside setting up these environment variables, you should source either
the PMinit.csh or the PMinit.sh script present in the $WORK/Pmake/base
directory.
</p>

<p>If you have followed our instructions well, you can set the entire environment with a single setup script that is generated in the new ODWork directory. You can source the 'init.bash' script from your .bashrc (or 'init.csh',if you work with the non-default csh shell). 

If you have created your ODWork directory in your home directory, you can add the following line to the end of your .bashrc script:
<pre>
    source ~/ODWork/init.bash
</pre>
</p>

<h3>Building your own plugins</h3>
<h4>Testing the installation</h4>

<p>
After you setup your environment, open a new shell and go to your ODWork directory. If all is well, the alias 'cwd' should bring you directly to your ODWork directory. Then go to the plugins directory and type 'make'. You should see something like this:
</p>
<pre>
$ cd plugins/

Administrator@tazzie-win2k /cygdrive/c/cygwin/home/Administrator/ODWork/plugins
$ make
make[1]: Entering directory `/cygdrive/c/cygwin/home/Administrator/ODWork/plugins/Hello'
  Making Hello / Microsoft Windows (Nov 27 13:18:33) DEBUG=no.
Compiling hellopi.cc ...
Ranlib on Hello.lib ...
Creating /cygdrive/c/cygwin/home/Administrator/ODWork/lib/win/O/Hello.dll ...
  Done !
make[1]: Leaving directory `/cygdrive/c/cygwin/home/Administrator/ODWork/plugins/Hello'

&lt;snip&gt;

make[1]: Entering directory `/cygdrive/c/cygwin/home/Administrator/ODWork/plugins/uiSeisIOSimple'
  Making uiSeisIOSimple / Microsoft Windows (Nov 27 13:19:14) DEBUG=no.
Compiling seisiosimple.cc ...
Compiling uiseisiosimple.cc ...
Compiling uiseisiosimplepi.cc ...
Ranlib on uiSeisIOSimple.lib ...
Creating /cygdrive/c/cygwin/home/Administrator/ODWork/lib/win/O/uiSeisIOSimple.dll
 ...
  Done !
make[1]: Leaving directory `/cygdrive/c/cygwin/home/Administrator/ODWork/plugins/uiSeisIOSimple'

Administrator@tazzie-win2k /cygdrive/c/cygwin/home/Administrator/ODWork/plugins
$</pre>
<p>The libraries should now be made in $WORK/lib/$HDIR. We can check that, like this:</p>
<pre>
Administrator@tazzie-win2k /cygdrive/c/cygwin/home/Administrator/ODWork/plugins
$ cdw

Administrator@tazzie-win2k /cygdrive/c/cygwin/home/Administrator/ODWork
$ cd lib/win/

Administrator@tazzie-win2k /cygdrive/c/cygwin/home/Administrator/ODWork/lib/win
$ ls
Coh.dll*    O@                 libuiSeisIOSimple.dll.a*  uiSeisIOSimple.dll*
Coh.lib*    libCoh.dll.a*      uiCoh.dll*                uiSeisIOSimple.lib*
G@          libHello.dll.a*    uiCoh.lib*
Hello.dll*  libuiCoh.dll.a*    uiHello.dll*
Hello.lib*  libuiHello.dll.a*  uiHello.lib*

Administrator@tazzie-win2k /cygdrive/c/cygwin/home/Administrator/ODWork/lib/win $
</pre>

<h4>Testing the newly compiled plugins</h4>

You can test your newly compiled plugins by loading them using the Utilities-plugins menu in OpendTect. For example, if you load the "Hello.dll" plugin, you should see "Hello World" on the OpendTect console window.
If you want to load one of the 'ui' plugins, you have to load the corresponding non-ui one first.

<a name=installplugins><h4>Installing your plugins</h4>

<p> The plugins are basically installed by copying them to the correct plugin subdirectory in either your personal '.od' settings directory, or in the program installation directory and making a configuration ".alo" file. 
This is the same on Unix and Windows, so please consult the plugins <a href="plugins.html#autoload">auto-load and installation</a> documentation for more details.
However, there are a few remarks about the location of your personal directory on windows. </p>

<a name=dist><h2>Distributing your plugins:</h2>

<p>
The distribution of plugins is basically the same for Unix and windows. 
Just copy the .alo files into the plugins/platform directory
    (<code>$DTECT_APPL/plugins/$HDIR</code>)
and copy the actual plugins into the libs subdirectory.
</p>

<p>
In order to do this, we use .tar.gz files on Unix and inno-setup on windows, which can be obtained for free at: <a href="http://www.jrsoftware.org/isinfo.php">jrsoftware.org</a>.
</p>


<br>
<img src="../hr.png" border=0>

<p>
<center>
  <a href="index.html">Index</a>
| <a href="overview.html">Overview</a>
| <a href="plugins.html">Plugins</a>
| <a href="pmake.html">Pmake</a>
| <a href="http://www.opendtect.org">opendtect.org</a>
</center>
</p>

</body>
</html>
